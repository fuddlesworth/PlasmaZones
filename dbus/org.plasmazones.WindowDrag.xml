<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"
    "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">
<node>
    <!-- Window Drag Interface (KWin script -> Daemon) -->
    <interface name="org.plasmazones.WindowDrag">
        <annotation name="org.gtk.GDBus.DocString" value="Window drag handling: KWin script calls dragStarted/dragMoved/dragStopped; daemon returns snap geometry. Uses double for window rect (KWin QML) and int for cursor/modifiers."/>
        <method name="dragStarted">
            <annotation name="org.gtk.GDBus.DocString" value="Called when a window drag begins. Window rect and app/window class for exclusion checks. Coordinates are double (KWin QML)."/>
            <arg name="windowId" type="s" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Window identifier."/>
            </arg>
            <arg name="x" type="d" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Window X position (double, KWin QML)."/>
            </arg>
            <arg name="y" type="d" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Window Y position (double)."/>
            </arg>
            <arg name="width" type="d" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Window width (double)."/>
            </arg>
            <arg name="height" type="d" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Window height (double)."/>
            </arg>
            <arg name="appName" type="s" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Application name (for exclusions)."/>
            </arg>
            <arg name="windowClass" type="s" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Window class (for exclusions)."/>
            </arg>
            <arg name="mouseButtons" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Qt::MouseButtons flags for the button(s) that started the drag (0=None, 2=Right, 4=Middle, 8=Back, 16=Forward, etc.). Used for activation-by-mouse-button."/>
            </arg>
        </method>

        <method name="dragMoved">
            <annotation name="org.gtk.GDBus.DocString" value="Called while the window is being dragged. Cursor position (int), keyboard modifiers and current mouse buttons (Qt flags)."/>
            <arg name="windowId" type="s" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Window identifier."/>
            </arg>
            <arg name="cursorX" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Cursor X position."/>
            </arg>
            <arg name="cursorY" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Cursor Y position."/>
            </arg>
            <arg name="modifiers" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Qt::KeyboardModifiers flags."/>
            </arg>
            <arg name="mouseButtons" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Qt::MouseButtons flags currently held (0=None, 2=Right, 4=Middle, etc.). Used to toggle overlay when activation is set to a mouse button (same as modifier: hold button during drag to show zones)."/>
            </arg>
        </method>

        <method name="dragStopped">
            <annotation name="org.gtk.GDBus.DocString" value="Called when the drag ends. Returns snap rectangle and whether to apply it (shouldSnap). cursorX/Y are the cursor position at release (for release screen detection). modifiers: Qt::KeyboardModifiers at release â€” used for Snap Assist triggers (when always-on is off)."/>
            <arg name="windowId" type="s" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Window identifier."/>
            </arg>
            <arg name="cursorX" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Cursor X at release (global coordinates)."/>
            </arg>
            <arg name="cursorY" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Cursor Y at release (global coordinates)."/>
            </arg>
            <arg name="modifiers" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Qt::KeyboardModifiers at release."/>
            </arg>
            <arg name="mouseButtons" type="i" direction="in">
                <annotation name="org.gtk.GDBus.DocString" value="Qt::MouseButtons at release. With modifiers, used for SnapAssistTriggers: when any trigger held, enables Snap Assist for this drop (when always-enabled is off)."/>
            </arg>
            <arg name="snapX" type="i" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="Snap X position (if shouldSnap)."/>
            </arg>
            <arg name="snapY" type="i" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="Snap Y position (if shouldSnap)."/>
            </arg>
            <arg name="snapWidth" type="i" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="Snap width (if shouldSnap)."/>
            </arg>
            <arg name="snapHeight" type="i" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="Snap height (if shouldSnap)."/>
            </arg>
            <arg name="shouldSnap" type="b" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="True if KWin should apply the snap geometry."/>
            </arg>
            <arg name="releaseScreenName" type="s" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="Screen name where the drag was released (cursor position). Use for auto-fill on drop."/>
            </arg>
            <arg name="restoreSizeOnly" type="b" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="If true with shouldSnap: apply only width/height; keep window at current position (drag-to-unsnap). Float-toggle shortcut restores full x/y/w/h."/>
            </arg>
            <arg name="snapAssistRequested" type="b" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="If true: effect should call showSnapAssist with candidate windows to fill empty zones."/>
            </arg>
            <arg name="emptyZonesJson" type="s" direction="out">
                <annotation name="org.gtk.GDBus.DocString" value="JSON array of {zoneId, x, y, width, height} for empty zones. Only set when snapAssistRequested is true."/>
            </arg>
        </method>

        <method name="cancelSnap">
            <annotation name="org.gtk.GDBus.DocString" value="Cancel the current snap operation (e.g. user pressed Escape)."/>
        </method>

        <signal name="windowSnapped">
            <annotation name="org.gtk.GDBus.DocString" value="Emitted when a window is snapped to a zone after drag."/>
            <arg name="windowId" type="s">
                <annotation name="org.gtk.GDBus.DocString" value="Window identifier."/>
            </arg>
            <arg name="zoneId" type="s">
                <annotation name="org.gtk.GDBus.DocString" value="Zone UUID."/>
            </arg>
        </signal>
        <signal name="snapCancelled">
            <annotation name="org.gtk.GDBus.DocString" value="Emitted when the snap was cancelled."/>
            <arg name="windowId" type="s">
                <annotation name="org.gtk.GDBus.DocString" value="Window identifier."/>
            </arg>
        </signal>
        <signal name="zoneGeometryDuringDragChanged">
            <annotation name="org.gtk.GDBus.DocString" value="Emitted when the zone geometry under the cursor changes during drag. KWin effect applies the geometry immediately for FancyZones-style snap-on-hover behavior."/>
            <arg name="windowId" type="s">
                <annotation name="org.gtk.GDBus.DocString" value="Window identifier."/>
            </arg>
            <arg name="x" type="i">
                <annotation name="org.gtk.GDBus.DocString" value="Zone X position (pixels)."/>
            </arg>
            <arg name="y" type="i">
                <annotation name="org.gtk.GDBus.DocString" value="Zone Y position (pixels)."/>
            </arg>
            <arg name="width" type="i">
                <annotation name="org.gtk.GDBus.DocString" value="Zone width (pixels)."/>
            </arg>
            <arg name="height" type="i">
                <annotation name="org.gtk.GDBus.DocString" value="Zone height (pixels)."/>
            </arg>
        </signal>
        <signal name="restoreSizeDuringDragChanged">
            <annotation name="org.gtk.GDBus.DocString" value="Emitted when the cursor leaves all zones during drag and the window was snapped. KWin effect applies pre-snap size immediately (restore-size-only at current position)."/>
            <arg name="windowId" type="s">
                <annotation name="org.gtk.GDBus.DocString" value="Window identifier."/>
            </arg>
            <arg name="width" type="i">
                <annotation name="org.gtk.GDBus.DocString" value="Pre-snap width (pixels)."/>
            </arg>
            <arg name="height" type="i">
                <annotation name="org.gtk.GDBus.DocString" value="Pre-snap height (pixels)."/>
            </arg>
        </signal>
    </interface>
</node>
